\hypertarget{BDAnA__Lab1__13_8py_source}{}\doxysubsection{BDAn\+A\+\_\+\+Lab1\+\_\+13.\+py}
\mbox{\hyperlink{BDAnA__Lab1__13_8py}{Див. документацію.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00001}\mbox{\hyperlink{namespaceBDAnA__Lab1__13}{00001}} \textcolor{comment}{\#!/usr/bin/env python3}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00003}00003 \textcolor{keyword}{import} matplotlib.pyplot \textcolor{keyword}{as} plt}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00004}00004 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00005}00005 \textcolor{keyword}{from} scipy.integrate \textcolor{keyword}{import} odeint}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00006}00006 \textcolor{keyword}{from} math \textcolor{keyword}{import} sin}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00008}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_afd236fd850ece9ef65745d5e481c7d68}{00008}} x = np.linspace(-\/1.0, 1.0, 5)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00009}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a77852aae67153b8bbf23bb8764611ef5}{00009}} y = np.linspace(-\/1.0, 1.0, 5)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00010}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_ae113aa99690aa98225544086a79de5d6}{00010}} z = np.linspace(-\/1.0, 1.0, 5)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00012}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a7705d435ba30b0a43503d7a9778a1ef7}{00012}} starts = [}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00013}00013     ([0.8, 0.8, 0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00014}00014     ([0.8, 0.8, -\/0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00015}00015     ([0.8, -\/0.8, 0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00016}00016     ([0.8, -\/0.8, -\/0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00017}00017     ([-\/0.8, 0.8, 0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00018}00018     ([-\/0.8, 0.8, -\/0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00019}00019     ([-\/0.8, -\/0.8, 0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00020}00020     ([-\/0.8, -\/0.8, -\/0.8], 10),}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00021}00021 ]}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00024}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_aff4cc32af674d7fcf20304e2d563480e}{00024}} \textcolor{keyword}{def }\mbox{\hyperlink{namespaceBDAnA__Lab1__13_aff4cc32af674d7fcf20304e2d563480e}{calc}}(X, t: int = 0) -\/> np.ndarray:}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00025}00025     x1, x2, x3 = X[0], X[1], X[2]}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00026}00026     \textcolor{keywordflow}{return} np.array([}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00027}00027         -\/x1+2*x2, -\/2*x2, -\/2*x1-\/2*x2-\/x3}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00028}00028     ])}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00031}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a76df9592a365b983b9e0330118ae4ac6}{00031}} \textcolor{keyword}{def }\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a76df9592a365b983b9e0330118ae4ac6}{print\_vector\_field}}(ax, x, y, z) -\/> None:}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00032}00032     X, Y, Z = np.meshgrid(x, y, z)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00033}00033     u, v, w = np.zeros(X.shape), np.zeros(Y.shape), np.zeros(Z.shape)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00034}00034     u, v, w = \mbox{\hyperlink{namespaceBDAnA__Lab1__13_aff4cc32af674d7fcf20304e2d563480e}{calc}}([X, Y, Z])}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00035}00035     \textcolor{comment}{\# Друкує на графік векторне поле.}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00036}00036     ax.quiver(X, Y, Z, u, v, w, color=\textcolor{stringliteral}{'r'}, length=0.1)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00041}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a278832e8032ad2f2b05d0bbea4ecec74}{00041}} \textcolor{keyword}{def }\mbox{\hyperlink{namespaceBDAnA__Lab1__13_a278832e8032ad2f2b05d0bbea4ecec74}{print\_trajectories}}(ax, starts: list) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00042}00042     \textcolor{comment}{\# Обчислюємо траєкторії задані у змінній `starts`}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00043}00043     \textcolor{keywordflow}{for} s, t \textcolor{keywordflow}{in} starts:}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00044}00044         \textcolor{comment}{\# Задаємо діапазон часу [0, t] та ділить відрізок на 2000 частин.}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00045}00045         tspan = np.linspace(0, t, 2000)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00046}00046         \textcolor{comment}{\# Інтегрує систему до заданого часу `t` та початкових значень `s`}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00047}00047         tr = odeint(calc, s, tspan)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00048}00048         \textcolor{comment}{\# Друкуєму саму траєкторію}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00049}00049         ax.plot3D(tr[:, 0], tr[:, 1], tr[:, 2])}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00050}00050         \textcolor{comment}{\# Друкуємо початок траєкторії у вигляді кружечка}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00051}00051         ax.plot3D([tr[0, 0]], [tr[0, 1]], [tr[0, 2]], \textcolor{stringliteral}{'o'})}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00052}00052         \textcolor{comment}{\# Друкуємо кінець траєкторії у вигляді квадратика}}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00053}00053         ax.plot3D([tr[-\/1, 0]], [tr[-\/1, 1]], [tr[-\/1, 2]], \textcolor{stringliteral}{'s'})}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00056}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_ac2f3ca35fe0d89b5168b01336f8a0572}{00056}} fig = plt.figure()}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00057}\mbox{\hyperlink{namespaceBDAnA__Lab1__13_aba30c39b375fef99c91db8a0bd415a89}{00057}} ax = fig.gca(projection=\textcolor{stringliteral}{'3d'})}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00058}00058 \mbox{\hyperlink{namespaceBDAnA__Lab1__13_a76df9592a365b983b9e0330118ae4ac6}{print\_vector\_field}}(ax, x, y, z)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00059}00059 \mbox{\hyperlink{namespaceBDAnA__Lab1__13_a278832e8032ad2f2b05d0bbea4ecec74}{print\_trajectories}}(ax, starts)}
\DoxyCodeLine{\Hypertarget{BDAnA__Lab1__13_8py_source_l00060}00060 plt.show()}

\end{DoxyCode}
